<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Inventario Helader√≠a</title>

<style>
body{
    font-family: Arial, sans-serif;
    background: linear-gradient(135deg,#ffe6f0,#fff);
    padding:15px;
    margin:0;
}

/* TITULO */
h1{
    text-align:center;
    color:#ff2a8a;
    font-size:26px;
}

/* TABLA */
table{
    width:100%;
    border-collapse:collapse;
    background:white;
    margin-top:20px;
    border-radius:10px;
    overflow:hidden;
    box-shadow:0 4px 10px rgba(0,0,0,0.1);
    table-layout: fixed;
}

th, td{
    padding:10px;
    text-align:center;
    border-bottom:1px solid #eee;
    font-size:16px;
}

th{
    background:#ff4fa3;
    color:white;
    font-size:17px;
}

/* PALITOS */
.palitos{
    font-size:18px;
    min-height:40px;
    max-height:140px;
    overflow-y:auto;
    white-space:pre-line;
    text-align:left;
}

/* NUMERO DE CONTEO */
[id^="num"]{
    font-size:18px;
    font-weight:bold;
}

/* BOTONES */
button{
    padding:8px 12px;
    margin:3px;
    border:none;
    border-radius:6px;
    cursor:pointer;
    font-weight:bold;
    font-size:15px;
}

.btn-mas{ background:#4CAF50; color:white;}
.btn-menos{ background:#f44336; color:white;}
.btn-limpiar{ background:#ff4fa3; color:white;}
.btn-exportar{ background:#2196F3; color:white;}

.total{
    margin-top:15px;
    font-size:19px;
    font-weight:bold;
    text-align:right;
}

.botones{
    margin-top:20px;
    text-align:center;
}

input{
    width:90px;
    padding:8px;
    text-align:center;
    border:1px solid #ddd;
    border-radius:5px;
    font-size:16px;
}

/* RESPONSIVE */
@media (max-width:600px){
    th, td{ font-size:17px; }
    h1{ font-size:24px; }
    button{ font-size:16px; padding:10px; }
}
</style>
</head>
<body>

<h1>üç¶ Conteo por Helado</h1>

<table id="tabla">
<thead>
<tr>
<th>Producto</th>
<th>Conteo</th>
<th>Palitos</th>
</tr>
</thead>
<tbody></tbody>
</table>

<div class="total">
Total General: <span id="totalGeneral">0</span>
</div>

<h1>üì¶ C√°lculo de Jabas</h1>

<table>
<tr>
<th>Unidades</th>
<th>Jabas x3</th>
<th>Total</th>
</tr>
<tr>
<td><input type="number" id="uni" oninput="calcularJabas()"></td>
<td><input type="number" id="j3" oninput="calcularJabas()"></td>
<td><span id="resultadoJabas">0</span></td>
</tr>
</table>

<div class="total">
Total Jabas: <span id="totalJabas">0</span>
</div>

<div class="botones">
<button class="btn-limpiar" onclick="limpiarTodo()">Limpiar</button>
<button class="btn-exportar" onclick="exportarExcel()">Exportar Excel</button>
</div>

<script>

let productos = [
"Paleta Fresa","Paleta Chocolate","Paleta Lucuma",
"Chispeka Vainilla","Chispeka Menta","Flor de jamaica",
"Chiclemon","Sacra Pi√±a","Sacra Fresa","Sacra Guanabano",
"Sacra Maracuya","Sacra Mango","Rellenita","Coco","Cafe",
"Casanova","Supay Chocolate","Supay Lucuma","Algarrobina",
"Ron con pasas","Chancaysito","Bisabor","Frambuco",
"Apu Chocolate","Apu Lucuma","Yanacha","Vasito","Aguaje","Litro de chocolate","Litro de Algarrobina"
,"Litor de Ron con Pasas","Litro de Tricolor","Litro de Chocochip"
];

let tabla = document.querySelector("#tabla tbody");
let contadores = new Array(productos.length).fill(0);

productos.forEach((producto, index)=>{
    let fila = document.createElement("tr");

    fila.innerHTML = `
        <td>${producto}</td>
        <td>
            <button class="btn-menos" onclick="cambiar(${index}, -1)">‚ûñ</button>
            <span id="num${index}">0</span>
            <button class="btn-mas" onclick="cambiar(${index}, 1)">‚ûï</button>
        </td>
        <td class="palitos" id="pal${index}"></td>
    `;

    tabla.appendChild(fila);
});

function cambiar(index, valor){
    contadores[index] += valor;
    if(contadores[index] < 0) contadores[index] = 0;

    document.getElementById("num"+index).innerText = contadores[index];
    dibujarPalitos(index);
    calcularTotal();
}

function dibujarPalitos(index){
    let cantidad = contadores[index];
    let grupos = Math.floor(cantidad / 5);
    let resto = cantidad % 5;
    let texto = "";

    for(let i = 0; i < grupos; i++){
        texto += "||||/ \n";
    }

    if(resto > 0){
        texto += "|".repeat(resto);
    }

    document.getElementById("pal"+index).innerText = texto;
}

function calcularTotal(){
    let total = contadores.reduce((a,b)=>a+b,0);
    document.getElementById("totalGeneral").innerText = total;
}

function calcularJabas(){
    let unidades = parseInt(document.getElementById("uni").value) || 0;
    let j3 = parseInt(document.getElementById("j3").value) || 0;
    let total = unidades + (j3 * 3);

    document.getElementById("resultadoJabas").innerText = total;
    document.getElementById("totalJabas").innerText = total;
}

function limpiarTodo(){
    contadores.fill(0);
    document.querySelectorAll("[id^='num']").forEach(el=>el.innerText="0");
    document.querySelectorAll("[id^='pal']").forEach(el=>el.innerText="");
    document.getElementById("totalGeneral").innerText="0";

    document.getElementById("uni").value="";
    document.getElementById("j3").value="";
    document.getElementById("resultadoJabas").innerText="0";
    document.getElementById("totalJabas").innerText="0";
}

function exportarExcel(){
    let datos = "Producto,Cantidad\n";

    productos.forEach((producto,index)=>{
        datos += producto + "," + contadores[index] + "\n";
    });

    datos += "\nTotal General," + document.getElementById("totalGeneral").innerText;
    datos += "\nTotal Jabas," + document.getElementById("totalJabas").innerText;

    let blob = new Blob([datos], {type:"text/csv;charset=utf-8;"});
    let url = URL.createObjectURL(blob);
    let a = document.createElement("a");
    a.href = url;
    a.download = "Reporte_Heladeria.csv";
    a.click();
}

</script>

</body>
</html>
